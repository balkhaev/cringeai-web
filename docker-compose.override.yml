# Development overrides - auto-loaded by docker compose
# Hot reload, source mounting, debug settings

services:
  server:
    build:
      target: deps  # Use deps stage for dev (skip production build)
    command: ["sh", "-c", "npx prisma migrate deploy && pnpm dev"]
    environment:
      NODE_ENV: development
    volumes:
      - ./apps/server/src:/app/apps/server/src:cached
      - ./packages:/app/packages:cached

  video-frames:
    environment:
      RELOAD: "true"  # Enable uvicorn hot reload
    volumes:
      - ./apps/video-frames/main.py:/app/main.py:cached

  scrapper:
    environment:
      RELOAD: "true"
    volumes:
      - ./apps/scrapper:/app/scrapper:cached

  web:
    build:
      target: deps
    command: ["sh", "-c", "pnpm dev"]
    environment:
      NODE_ENV: development
    volumes:
      - ./apps/web/src:/app/apps/web/src:cached
      - ./apps/web/public:/app/apps/web/public:cached
